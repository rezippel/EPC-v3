%$Id: denesting.tex,v 1.1 1992/05/10 19:35:07 rz Exp rz $
\chapter{Denesting Radicals}
\label{Denesting:Chap}

This chapter discusses a type of radical simplification that does not
affect our ability to compute with an algebraic quantity, but does
improve our understanding of the nature of the algebraic quantity.

Typical of these very non-trivial simplifications is the following problem
of {\Ramanujan} \cite{Ramanujuan:Problems}:
\begin{equation}
\label{Cube:2:Radical:Eq}
\root 3 \of{\root 3 \of 2 -1} = \root 3 \of {1 \over 9} - 
\root 3 \of {2 \over 9} + \root 3 \of {4 \over 9}
\end{equation}
The left hand side is a cube root of the field $K = \Q(\root 3 \of 2)$.
The right hand side is an element of the field $\Q(\root 3 \of 2, \root 3
\of 3)$, which is a compositum of $K$ and $F = \Q(\root 3 \of 3)$.  First
notice that $\root 3 \of 2 - 1$ is not a perfect cube in $K$.  This can be
seen by looking at the image of $K$ in $\Z/31\Z$.  $x^3 - 2$ splits into
linear factors modulo 31.  The images of $x^3 - \root 3 \of 2 + 1$ are all
irreducible modulo 31.  Equivalently we could use an algebraic factoring
algorithm to show that $x^3 - \root 3 \of 2 + 1$ is irreducible over
$\Q(\root 3 \of 2)$.

One of the key points to note about \eqnref{Cube:2:Radical:Eq} is that
while $\root 3 \of 2 - 1$ is not a perfect cube in $K$, $9 \root 3 \of 2 -
9$ is.  In \sectref{Denesting:Structure:Sec} we prove a general structure
theorem that makes this observation precise.  Using this theorem we are
able to produce a necessary condition for a multiply nested radical to
denest and we use it as the basis of an algorithm which we present in the
second section.  Using this algorithm and other heuristics we produce a
number of interesting examples that are presented in the third section.
These examples are general formulae that may be used in place of the more
complicated algorithm.

\section{The Structure Theorem}
\label{Denesting:Structure:Sec}

In this section we produce a structure theorem that indicates 
when a field of nesting level $n$ can be mapped isomorphically to a field
of nesting level $n - 1$.  To be precise consider the following tower
of fields: 
\[
\begin{tikzcd}[column sep=small]
                            &L=KF \arrow[dash]{ld} \arrow[dash]{rd}  & \\
K \arrow[dash]{rd} & & F\arrow[dash]{ld} \\
& k= K\cap F & 
\end{tikzcd}
\]

%\[
%\begin{diagram}
%\node[2]{L=KF} \arrow{sw,-} \arrow{se,-} \\
%\node{K} \arrow{se,-} \node[2]{F} \arrow{sw,-}\\
%\node[2]{k= K \cap F}
%\end{diagram}
%\]
where $L$ is the compositum of the fields $K$ and $F$.  The following 
theorem is useful \cite{Lang:Algebra}:

\begin{proposition}
Let $K$, $F$, $k$ and $L$ be as above, $L$ galois over $K$.  Then $F$
is galois over $k$ and the galois group of $L$ over $K$ is isomorphic
to the galois group of $F$ over $k$.
\end{proposition}

\noindent
Now assume that $L = K(\root r \of \alpha)$. We can now prove the main 
theorem of this section. 

\begin{proposition}
Assume $K$ is an extension of $k$, a field that
contains a primitive $r$\th\ root of unity $\zeta_r$.  $L$ is an simple radical
extension of $K$, $K(\root r\of\alpha)$ for some $\alpha$ in $K$.  If
there exists a field $F$, such that the intersection of $K$ and $F$ is
$k$ and $L = KF$, then there exists a $\beta \in k$ such that $\alpha
\beta$ is an element of $K^{\ast r}$.  Furthermore, 
$F = k(\root r \of\beta)$. 
\end{proposition}

\begin{proof}
Since $K$ contains a primitive $r$\th\ root of unity
$L/K$ is a normal extension, and thus $F/k$ is also normal.  Let $G$
be the galois group of $L/K$. The automorphisms of $L$ that fix $K$ are
those that send $\root r \of \alpha$ to $\zeta_r \root r \of \alpha$.  Thus $F$
is cyclic over $k$, and by the corollary to Hilbert's Theorem 90, $F$ is
generated by $\root r \of \gamma$ where $\gamma$ is an element of $k$.  Let
$\sigma$ be a generator of $G$ such that 
$\sigma(\root r \of {\alpha}) = \zeta_{\sigma} \root r \of {\alpha}$ and
$\sigma(\root r \of {\gamma}) = \bar \zeta_{\sigma} \root r \of {\gamma}$.
$L = K(\root r \of {\gamma})$ and $[L\, :\, K]$ is equal to  $[F\, :\, k]$ so
$\root r \of {\gamma}$ is of degree $r$ over $K$.  Therefore $\bar
\zeta_\sigma$ must be a 
primitive root of unity.  There is an $m$ such that
$\bar \zeta\sigma^m \zeta_{\sigma} = 1$ and $\bar \zeta\sigma^m$ is a
primitive $n$\th\ root of unity.  Letting $\root r \of {\beta}$ be
$(\root r \of {\gamma})^m$ we have 
\[
\sigma(\root r \of {\alpha}\root r \of {\beta}) = 
\bar \zeta\sigma^m \zeta_{\sigma} \root r \of {\alpha}\root r \of
{\beta} =  
\root r \of {\alpha}\root r \of {\beta}.
\]
Thus $\root r \of {\alpha} \root r \of {\beta}$ is fixed by $G$ and must be in
$K$.  So $\alpha \beta$ is an element of $K^{\ast r}$.  Also, $F =
k(\root r \of{\gamma^m}) = k(\root r\of\beta)$.
\end{proof}

As an example of the use of this theorem consider $\sqrt{5 + 2 \sqrt{6}}$,
$K = \Q(\sqrt{6})$.  The only proper subfield of $K$ is $\Q$
so $K \cap F = \Q = k$.  We are looking for a element $\beta$, of $\Q$, for 
which $\beta (5 + 2 \sqrt{6})$ is a perfect square $(a + b \sqrt{6})^2$.
We would then have the denesting: 
\[
\sqrt{5 + 2 \sqrt{6}} = {a + b \sqrt{6} \over \sqrt{\beta}}.
\]
Trying a few small integers we see that 
$2 (5 + 2 \sqrt{6}) = (2 + \sqrt{6})^2$ and 
$3 (5 + 2 \sqrt{6}) = (3 + \sqrt{6})^2$.
These lead to the denestings
\[
\sqrt{5 +2\sqrt{6}} ={2 + \sqrt{6} \over \sqrt{2}} = \sqrt{2} + \sqrt{3}
\]
and 
\[
\sqrt{5 +2\sqrt{6}} ={3 + \sqrt{6} \over \sqrt{3}} = \sqrt{2} + \sqrt{3}.
\]

In the general quadratic case we want to find a denesting for $\sqrt{p +
\sqrt{q}}$.    By theorem {\bf 9} there must be a $\beta$ and $a_0$,
$a_1$ such that 
\[
\beta\,(p + \sqrt{q}) = (a_0 + a_1 \sqrt{q})^2.
\]
By equating the coefficients of $\sqrt{q}^0$ and $\sqrt{q}^1$, we get
two equations in three variables $a_0$, $a_1$ and $\beta$.
Since $a_0$, $a_1$ and $\beta$ are elements of a field we may assume $a_1 = 1$
to reduce the equations to 
\[
\beta p = a_0^2 + q, \qquad \beta = 2 a_0
\]
or
\[
\beta^2 - 4 \beta p + 4 q = 0.
\]
For this polynomial in $\beta$ to have a linear factor, its discriminant
must be a perfect square, that is $p^2 - q$ must be a perfect square.   
Letting $d^2 = p^2 - q$, we have $\beta = 2\,(p \pm d)$ and 
$a_0 = p \pm d$.  This gives a denesting of $\sqrt{p + \sqrt{q}}$ as
\[
\sqrt{p + \sqrt{q}} = \left(p \pm d + \sqrt{q}\right) 
\,{1 \over \sqrt{2 \,(p \pm d)}}.
\]
By replacing $\sqrt{q}$ by $\sqrt{p^2 - d^2}$ we have the following
classic denesting formula: 
\[
\sqrt{p + \sqrt{q}} = \sqrt{p + d \over 2} +  \sqrt{p - d \over 2}.
\]

\medskip
Notice that the denestings that are produced by the theorem 
will occur in $L$, an extension of degree $r$ over $K$.  
There may be denestings which only occur in fields of higher degree.
One example of this type of denesting is
\[
\sqrt{12 + 5\sqrt{6}} = \sqrt{2} \root 4 \of 6 + \sqrt{3} \root 4 \of 6.
\]
We have been unable to provide a necessary and sufficient condition for
when such denesting occur.  However close examination of this particular
example reveals another type of denesting structure.

Although there is no integer $\beta$ such that $\beta\,(12 + 5 \sqrt{6})$
is a perfect square,
\[
{\sqrt{6} \over 3} (12 + 5 \sqrt{6}) = 10 + 4 \sqrt{6} = (2 + \sqrt{6})^2.
\]
Although we could not find an element in $\Q$ by which to multiply 
$12 + 5 \sqrt{6}$ to get a perfect square, there was a {\em monomial} in
$\Q(\sqrt{6})$ that could be used.

As a consequence we make the following conjecture which we believe
completely characterizes when a simple radical expression can be
denested.

\begin{conjecture}
Let $K = k(\gamma_1, \ldots, \gamma_\ell)$, where each of the
$\gamma_i$ are radicals, $F$ be the compositum of simple radical
extensions of $k$.  Let $\alpha$ be an element of $K$.  If $\root r\of
\alpha$ is an element of $KF$ (can be denested) then there exist
integers $s_i$ and element $\beta\in k$ such that 
$\gamma_1^{s_1} \cdots \gamma_\ell^{s_\ell} \beta \alpha$ is an
element of $K^{\ast r}$. 
\end{conjecture}

\section{Denesting Formulae for Square Roots}
\label{Denesting:Square:Roots:Sec}

The most common radicals that occur in calculations seem to be square
roots.  In this section we will mention a few curious denesting results
that are derivable from our general structure theorem. 

First, examine a slight generalization of the quadratic denesting formula
discussed in the previous section.  Let $A$, $B$ and $q$ be elements of a
field $k$.  We are looking for a denesting of $\sqrt{A + B\sqrt{q}}$.  We
again assume there is a $\beta \in k$ such that
\[
\beta\, (A + B \sqrt{q}) = (a_0 + \sqrt{q})^2.
\]
Now the equations we must solve are
\[
\beta A = a_0^2 + q \qquad\hbox{and}\qquad \beta B = 2 a_0.
\]
Using the same techniques we discover that $A^2 - q B^2$ (the norm of 
$A + B \sqrt{q}$) must be a perfect square, $d^2$.  Then
\[
\begin{aligned}
\beta &= {2 \over B^2} \,(A \pm d),\\
a_0 &= {1 \over B} \,(A \pm d).
\end{aligned}
\]
Choosing the positive sign,
\begin{eqnarray*}
\lefteqn{\sqrt{A + B \sqrt{q}} = \left[{1 \over B} (A + d) + \sqrt{q}\right]
\sqrt{B^2 \over 2 (A + d)}} \\
&\qquad = \left[A + d \pm \sqrt{A^2 - d^2}\right] 
{1 \over \sqrt{2 \, (A + d)}}\\
&\qquad = \sqrt{A + d \over 2} \pm \sqrt{A - d \over 2},
\end{eqnarray*}
where the sign of the second square root depends on the sign of $B$.  Both
denestings given on the right hand side above are useful.

If $A^2 - B^2 q$ is not a perfect square, we next try looking for a
$\beta$ such that $\beta\,(A \sqrt{q} + B q)$ is a perfect square.  That
is having discovered that $\sqrt{A + B \sqrt{q}}$ does not denest in a
simple quadratic extension of $K = k(\sqrt{q})$ we now look for a
quartic extension in which it denests.

Now we assume that $B^2 q^2 - A^2 q$ is a perfect square $d^2$.  Now, we
can write $\sqrt{A + B \sqrt{q}}$ as
\[
\begin{aligned}
\sqrt{A + B \sqrt{q}} & 
= {1 \over \root 4 \of q} \sqrt{B q + A \sqrt{q}}\\
&= {1 \over \root 4 \of q} \left[ Bq + d \pm \sqrt{q} \right]
{1 \over \sqrt{2\,(B q + d)}}\\
&=\left[{1 \over q} (Bq + d) {\root 4 \of q}^3 + {\root 4 \of q}\right]
{1 \over \root 4 \of{4\,(B q + d)^2}}\\
&={1 \over q} {\root 4\of{4\,(Bq +d)^2}} {\root 4\of q}^3
+ {1 \over 2\,(Bq+d)} {\root 4\of{4\,(Bq+d)^2}} {\root 4\of q}\\
&= {1 \over 2 (Bq +d)} {\root 4 \of{4 q(Bq+d)^2}}^3 +
{1 \over 2\,(Bq+d)} \root 4\of{4 q\,(Bq+d)^2}
\end{aligned}
\]

This final formula can be rewritten as 
\[
\sqrt{A + B \sqrt{q}} = 
{1 \over 2 (Bq + d)} \,\left( \root 4\of{4q\,(Bq+d)^2} + 
{\root 4\of{4q\,(Bq+d)^2}}^3 \right).
\]
Notice that we have denested a radical in a quartic extension of $k$,
$L$ that is not a quadratic extension of $K$.  In fact $L \cap K = k$.
This gives us two denesting formul\ae\ for expressions involving two
square roots.  Borodin, Fagin, Hopcroft and Tompa
\cite{Borodin:Radicals} demonstrate that these are the only ways in
which expressions involving square roots can be denested.  This also
lends some support to the conjecture at the end of section {\bf 3.1}.

\medskip
The galois structure $K = k(\alpha) = k(\sqrt{A+B \sqrt{q}})$ can also
be used to determine a the denestings of radicals on certain occasions.
First, under what circumstances is $K$ normal over $k$?  This will
happen when $\bar \alpha = \sqrt{A - B\sqrt{q}}$ is an element of $K$.
Since 
\[
{1 \over \alpha} = \sqrt{A - B \sqrt{q} \over A^2 - B^2 q},
\]
if $\bar \alpha$ is in $K$, then $\sqrt{A^2-B^2 q}$ must also be in $K$.
In particular, if $A^2 - B^2 q$ is a perfect square then $K$ is a normal
extension of $k$ of degree 4.  Thus the galois group of $K$ over $k$ is
either $C_4$ or $C_2 \times C_2$.  By Hilbert's theorem 90,
\propref{Hilbert:Ninety:Prop}, if the galois group were $C_4$ there
would be an element $a$ in $k$ such that $\root 4\of a \in K$.  We
leave it to the reader to verify that this is possible only when $A = 0$.

Since the Galois group is $C_2 \times C_2$, there are two subfields
fixed by each of the order 2 subgroups.  These subfields are generated
by $\sqrt{A \pm d}$.

\section{General Denesting Formulae}
\label{Denesting:General:Sec}

It is easy to extend the techniques of the last section 
to extensions of $k$ of arbitrary degree.
Unfortunately, the systems of equations
can become quite unwieldy when the degree is very large.
In general we wish to denest the expression
$\root r \of {a_0 + \cdots + a_{n - 1} \alpha^{n-1}}$
where $\alpha$ is an algebraic variable of degree $n$ and where
$a_0 + \cdots + a_{n -1} \alpha^{n - 1}$ is an element of $K$.
Let $\beta$ be an element of a subfield of $K$ whose $r$\th\ root causes
the radical to denest.  Then we are looking for 
solutions of the system of equations 
\[
\beta\,(a_0 + \cdots + a_{n-1} \alpha^{n-1}) = 
(x_0 + \cdots + x_{n-1} \alpha^{n-1})^r
\]
where the $x_i$ and $\beta$ must all lie in some proper subfield of $K$.
Since one of the $x_i$ must be non-zero we may assume it is 1.
This would lead to $n$ equations in the $n - 1$ variables $x_i$ and $\beta$.
In general we may not know which of the $x_i$ is not zero.  However, the 
system of equations is homogeneous.  Since we are looking
for solutions which lie in a field, the extra indeterminate does not
cause any problems.  Using the standard elimination techniques, we
will be left with a homogeneous polynomial in two variables for which
we want a linear factor.

{\Ramanujan} \cite{Ramanujuan:Notebooks} determined a number of very
general formulae along these lines.  Among the most interesting are 
\[
\displaylines{\root 3 \of {(m^2 +mn+n^2) \root 3 \of {(m-n)(m+2n)(2m+n)} 
+ 3mn^2 +n^3 - m^3}\hfill\cr
\hfill= \root 3 \of {(m-n)(m+2n)^2 \over 9}
-  \root 3 \of {(2m+n)(m-n)^2 \over 9}
+  \root 3 \of {(m+2n)(2m+n)^2 \over 9}\cr}
\]

\[
\displaylines{\sqrt{m \root 3 \of {4m - 8n} + n \root 3 \of {4m+ n}}\hfill\cr
\hfill= {1 \over 3} \left( \root 3 \of {(4m+n)^2} +
\root 3 \of {4(m-2n) (4m+n)} - \root 3 \of {2(m-2n)^2}\right)\cr}
\]

These amazing examples illustrate the skill of one of the
greatest algebraic manipulators of all time.  Our  
technique for denesting radicals of the form $\root 3 \of {\root 3 \of q +p}$
leads to a polynomial of degree 24, from which
we are expected to divine the appropriate polynomials for $p$ and $q$ for
which it has a polynomial zero; e.g., a twenty fourth degree polynomial
diophantine problem in three variables.  Needless to say, there are no
general techniques which apply.  This is unfortunate since it would be
desirable to show that these two identities are the only denesting
formulae of their type.  This was shown in the case of the quadratic
denesting formula of the previous section.

However, we are able to conjecture how someone 
with a very fertile imagination might produce formulae like these.
Notice that the form $a^2 b + b^2 c + c^2 a$ may be written as 
\[
{1 \over b^2 c} \left[1 + {\alpha \over b^3} + {\alpha^2 \over b^3 c^3}
\right],
\]
where $\alpha$ is $a b c$.  In view of the theorem of the preceding
section this looks like a good candidate for a denested radical if we
let $a$, $b$ and $c$ be cube roots.  Replacing $a$, $b$ and $c$
by their cube roots and cubing the resulting form we get 
\[
3 \root 3 \of {\alpha}\left( \root 3 \of {\alpha}(a + b + c) +ab + bc +ac\right)
+ a^2b + b^2c +ac^2 + 6abc.
\]
Thus taking $a + b + c$ to be zero we get an interesting radical which will 
denest, and which is actually a generalization of {\Ramanujan}'s. 
\[
\root 3 \of {3 \root 3 \of {a b (a + b)} - (b^3 + 6 a b^2 + 3 b a^2 - a^3)} =
\root 3 \of {a^2 b} - \root 3 \of {b^2 (a + b)} + \root 3 \of {a (a + b)^2}
\]
Taking $a = m - n$ and $b = m + 2 n$, and removing a factor of $9$ from
the left hand side we get the first of {\Ramanujan}'s identities.  The
second identity can be derived by a similar but more difficult technique.

\section{Examples of the Denesting Algorithm}
\label{Denesting:Examples:Sec}

First, we will finish up the solution of Shanks' problem: 
\[
\sqrt{11 + 2 \sqrt{29}} + \sqrt{16 - 2 \sqrt{29} + 2 \sqrt{55 - 10
\sqrt{29}}}
= \sqrt{22 + 2 \sqrt{5}} + \sqrt{5}.
\]
With this problem we must be careful as to which field we consider to be
$k$.  We will indicate $k$ by saying $\alpha$ denests over $k$.
We need to denest the triply nested radical.  (The doubly nested ones cannot
be denested (over $\Q$) by the quadratic formula, and thus they
cannot be denested at all.)  Denote the triply nested radical by $\alpha$ and
the doubly nested radical it contains by $\beta$.  We first notice that
$\beta$ cannot be denested over $\Q$.  The field $\Q(\sqrt{29}, \beta)$
has two subfields.  We judiciously try denesting $\alpha$ over
$\Q(\sqrt{29})$.  Using the quadratic denesting formula 
\[
d^2 = (16 - 2\sqrt{29})^2 - 4 (55 - 10\sqrt{29}) = 
152 - 24 \sqrt{29}.
\]
Now all we need do is determine if $152 - 24\sqrt{29}$ is a perfect square
in $\Q(\sqrt{29})$.  Using algebraic factoring (or denesting
$\sqrt{152 - 24 \sqrt{29}}$ over $\Q$) we see that 
$d = \pm (6 - 2 \sqrt{29})$.  Thus 
\[
\alpha = \sqrt{16 - 2 \sqrt{29} + d \over 2} +
\sqrt{16 - 2 \sqrt{29} - d \over 2} = \sqrt{11 - 2 \sqrt{29}} + \sqrt{5}.
\]
as desired.

Consider the first problem given in the introduction: 
$\root 3 \of {\root 3 \of 2 -1 }$.
Here we seek $x_0$, $x_1$, $x_2$ such that 
\[
\root 3 \of {\root 3 \of 2 -1 } =
{x_0 + x_1 \root 3 \of 2 + x_2 \root 3 \of 4 \over \root 3 \of \beta}.
\]
Assuming $x_0$ to be 1 and equating like coefficients of $\root 3 \of 2$
we have the following set of equations: \
\[
\begin{aligned}
- \beta &= 2 x_2^3 - 12x_1 x_2 - x_1^3 - 4,\\
\beta &= 6 x_2^2 - 3 x_1^2 x_2 - 6 x_1,\\
0 &= -3 x_1 x_2^2 - 6 x_2 - 3 x_1^2.
\end{aligned}
\]
Eliminating $\beta$ from the first two equations, and then eliminating $x_2$
from the remaining two equations, we get the following equation which $x_1$
must satisfy: 
\[
x^9 - 9 x^7 - 6 x^6 + 54 x^5 + 36 x^4 - 96 x^3 - 108 x^2 - 36 x - 8
\]
whose only rational zeroes are $-1$ and 2.  A similar polynomial may be deduced
for $x_2$.  This polynomial has roots 1 and $-2$.  If on the other
hand we were to eliminate $x_1$ and $x_2$ we would get a polynomial
of degree 20.  This polynomial has 9, 18 and 36 as its rational zeroes.
To get the denesting from just this we must
factor $x^3 - 9 (\root 3 \of 2 - 1)$ over $\Q(\root 3 \of 2)$.
\[
x^3 - 9(\root 3 \of 2 - 1) = (x - (1 - \root 3 \of 2 + \root 3 \of 3))
(x^2 + (1 - \root 3 \of 2 + \root 3 \of 3)x + 3 \root 3 \of 4 - 3)
\]
And finally 
\[
\root 3 \of {\root 3 \of 2 -1} = \root 3 \of {1 \over 9} 
- \root 3 \of {2 \over 9} + \root 3 \of {4 \over 9}
\]


\section*{Notes}

\footnotesize

\notesectref{Denesting:Square:Roots:Sec} {\Borodin}, {\Fagin},
{\Hopcroft} and {\Tompa} \cite{Borodin:Radicals} have developed
algorithms for denesting expressions involving square roots.

\normalsize
